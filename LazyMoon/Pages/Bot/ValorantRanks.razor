@page "/Bot/ValorantRanks/{text}"
@inject Class.TwitchBot Bot
@inject NavigationManager NavigationManager

<div style="text-align : center;">
    <img src="@image" />
    <h1>@markName</h1>
    <h2>@score</h2>
</div>

@code {
    [Parameter]
    public string Text { get; set; }

    string image;
    string markName;
    string score;

    private Class.TwitchBot.Bot bot;

    public class ValorantRating
    {
        public string MarkName;
        public string MarkImage;
    }

    public int ranking;

    public List<ValorantRating> valorantRatings = new List<ValorantRating>();

    protected override async Task OnInitializedAsync()
    {

        Text = Encryption.Encryption.Decrypt(Text);
        bot = Bot.GetBot(Text);
        if (bot == null)
            NavigationManager.NavigateTo(NavigationManager.BaseUri + "Bot");

        bot.valorantRank.OnChangeRank += OnChangeRank;
        bot.valorantRank.GetRank();
        await this.InvokeAsync(new Action(() => { StateHasChanged(); }));
    }

    protected void OnChangeRank(int score, string rank, string path)
    {
        image = path;
        markName = rank;
        this.score = score.ToString();
        this.InvokeAsync(new Action(() => { StateHasChanged(); }));
    }
}
